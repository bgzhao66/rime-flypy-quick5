# -*- coding: utf-8 -*-

import re
import sys
import argparse

kZhuWords = set("""
专著
刘著
卓著
原著
史著
合著
名著
土著
大著
崔著
巨著
张著
所著
拙著
撰著
新著
无著
昭著
显著
杂著
李著
王著
编著
著书
著作
著名
著录
著文
著明
著称
著者
著译
著身
著述
著重
论著
译著
较著
遗著
钜著
馨著
何著胜
吕公著
土著人
大著作
方著作
显著地
显著性
显著的
显著者
编著者
著作人
著作史
著作权
著作者
著作郎
著名权
著名的
龚著剑
专著概览
世界著名
以微知著
仰屋著书
众目昭著
佛头著粪
信誉卓著
功劳卓著
功勋卓著
劣迹昭著
卓著威名
发愤著书
名著在线
四大名著
国内著名
国际著名
声誉卓著
外国名著
大附著散
威望素著
学术专著
学术著作
小附著散
彰明昭著
彰明较著
恶迹昭著
惊人显著
成效卓著
成效显著
成绩卓著
成绩显著
战功卓著
效果显著
文学名著
日新月著
显著加强
显著地位
显著成效
显著成绩
显著提高
显著效果
显著标志
显著特点
档案著录
殆显著的
比较显著
水中著盐
深切著明
深切著白
画蛇著足
皇皇巨著
睹微知著
睹著知微
科学著作
积微成著
积微致著
等身著作
罪恶昭著
臭名昭著
著书立言
著书立说
著书等身
著于竹帛
著作权人
著作权法
著作等身
著名主持
著名人士
著名企业
著名作家
著名品牌
著名商标
著名导演
著名教授
著名景点
著名演员
著名画家
著名经济
著名诗人
著者目录
著者索引
著述等身
见微知著
视微知著
识微知著
超超玄著
遐迩著闻
重要著作
非常显著
鸿篇巨著
名岂文章著
妙手著文章
寒梅著花未
显著性影响
显著性检定
显著性检验
显著性水平
见微而知著
长安遇冯著
丁著
丛著
丹著
仁著
伍著
俞著
修著
公著
冯著
卢著
又著
古著
叶著
吕著
吴著
周著
唐著
基著
子著
孙著
宁著
宓著
宗著
岑著
巫著
师著
帝著
康著
廉著
弓著
弘著
徐著
德著
惠著
戈著
文著
智著
曹著
林著
柯著
桑著
梁著
此著
毛著
永著
沈著
洪著
熊著
玄著
玉著
甘著
祖著
简著
缪著
肖著
莫著
萧著
著县
著史
著有
葛著
蔡著
袁著
诗著
辛著
邵著
郎著
金著
陶著
东著玄
乌斯著
云著蝉
仲马著
伍德著
何著青
余华著
俞樾著
倪匡著
傅玄著
先生著
刘向著
华著清
卢梭著
古龙著
吴淑著
吴著冲
周著祖
唐人著
姚谦著
孟森著
宋慈著
宋著玲
宦著学
尼父著
尼采著
席绢著
常著赤
庄羽著
康德著
张先著
张文著
张载著
彭著霞
影著协
德特著
怀特著
战著勋
戴著腕
摄著协
文著协
斯基著
斯密著
斯通著
方方著
明著天
明著灵
普勒著
曹禺著
曾朴著
曾著诗
曾著赋
朱应著
李冶著
李明著
李维著
杨著恩
杨著昆
格林著
梅著雨
沈著飞
洛斯著
王蒙著
班固著
祝著节
禄抱著
福柯著
程著卿
罗斯著
罗琳著
罗素著
耿著兮
胡著伟
胡适著
艾伦著
艾束著
莫尔著
莫愚著
萧韩著
著些子
著佐权
董桥著
蒋祁著
蓝兮著
蔡邕著
藤生著
藤著木
袁枚著
袁著祉
许慎著
贝克著
贝祖著
赖特著
郎著轻
郝歪著
郭著章
鄂勒著
金庸著
金波著
钱穆著
陆羽著
陈寿著
霍金著
韦伯著
韦达著
韩寒著
韩松著
音著协
马丁著
马拉著
马斯著
马登著
高登著
魏巍著
魏收著
鲍姆著
黄著诚
黄长著
齐人著
齐著铁
傅玄著诗
加藤繁著
千百秀著
司马光著
司马迁著
和田清著
张恨水著
欧阳修著
流潋紫著
积著之理
范文澜著
郭敬明著
黄百家著
稻盛和夫著
彼得海斯勒著
五百年来谁著史
文章合为时而著
尼日利亚钦努阿著
医著
范著
纪著
珑著
尤著
宾著
陈著
益著
寇著
费著
马欢著
辛格著
应劭著
莫斯著
山口升著
曲江华著中城
郭著
阀著
韦著
赵著
梅著
雷著
傅著
夏著
顾著
浦著
韶著
殳著
符著
宫著铭
卡尔著
尚著
士著
灵著
郑著
庄著
暴著
温著
干宝著
""".split())

def fix_notzhu_pattern(text):
    if '著' in text:
        found = False
        for i in range(len(text) - 1):
            for k in range(2, 10):
                if i + k >= len(text):
                    continue
                if text[i:i+k] in kZhuWords:
                    found = True
                    break
        if not found:
            text = re.sub(r'著', '着', text)
    return text

kQianWords = set("""
干亨
干佑
干宫
干巽
干德
干祐
干门
干贞
元干
尚干
巫干
帝干
振干
玄干
甲干
雍干
丁干村
丁兆干
丁其干
丁象干
丁雍干
上干山
上干村
上巽干
丘干村
东干岗
严仲干
严立干
中干龙
乌石干
干丰乡
干丰镇
干为天
干佑河
干佑镇
干凤寺
干凤阁
干凰阁
干务镇
干华园
干口村
干和园
干和城
干唐轩
干埝塘
干堰湾
干塘坡
干塘湾
干塘镇
干宁军
干安县
干安街
干安路
干安镇
干宝岱
干家浜
干寿街
干山村
干德门
干恩园
干戌午
干成源
干明寺
干正兴
干泰寺
干泽园
干济堂
干清园
干清宫
干清门
干源村
干溪坝
干潭村
干潭镇
干炳村
干瑞鸿
干生元
干田堡
干皇府
干皇阁
干福寺
干裕楼
干西乡
干贵士
干达婆
干阳村
干阳汤
干阳石
干顺恒
干顾腾
干鸿苑
干龙乡
干龙池
干龙路
于干佑
于干化
于干宁
于干安
于干德
于干明
于干符
于干统
于兴干
于承干
于清干
亨干口
从干清
付应干
代干山
任干卫
伏干归
何干鸿
何广干
何正干
侍居干
侯相干
侯羽干
侯邓干
保干图
俞元干
傅三干
傅干九
傅学干
元干亨
元干统
元曰干
公冶干
公在干
公孙干
兰干龙
内廷干
冉干宾
冯日干
冯秀干
刘上干
刘干兴
刘干安
刘干德
刘干才
刘干相
刘体干
刘增干
刘宗干
刘振干
刘洪干
刘竹干
刘耀干
北有干
南干村
南接干
南汉干
卢振干
叶干华
叶兴干
叶奕干
叶子干
后沥干
吕佑干
吕宝干
吴干春
吴干浩
吴干炜
吴干玮
吴干贞
吴素干
吴越干
吴运干
周干兴
周保干
周士干
周家干
周登干
和干安
唐干宁
唐干封
唐干符
唐定干
夏干良
夏伯干
大干慧
大干村
大干溪
大哉干
大奋干
天干蝶
太干仙
太干意
姚学干
姚振干
姚秉干
姜干金
姬叔干
娄干贵
子干干
子干顺
子行干
孔尚干
孙干保
孙干先
孙干守
孙干来
孙干泉
孙干至
孙干见
孙干领
孙炳干
孙荣干
孙道干
季干斌
安法干
宋干兴
宋干家
宋干德
宋干武
完干汁
完颜干
宗干宁
宗干通
宗在干
宗朝干
宗李干
宫干寿
尚德干
尚立干
尹孝干
尹祚干
尼干子
居干宫
居干西
岳干斋
崔干佑
崔干右
崔干祐
崔干祜
崔干裙
崔永干
庄干竹
应乎干
庞西干
康应干
康立干
康雍干
廖干五
廖干吾
张干东
张干二
张干勋
张干文
张干琦
张干祥
张干青
张云干
张体干
张保干
张国干
张学干
张小干
张志干
张思干
张振干
张效干
张曾干
张有干
张槐干
张正干
张法干
张炳干
彭盛干
彭象干
徐干学
徐干清
徐光干
徐振干
徐绅干
慕容干
战乎干
战于干
戴干亨
戴干圜
戴干宇
戴干建
承干官
承干宫
承干意
承干殿
掌干清
文干义
文干刚
方干之
方君干
方拱干
方振干
方积干
方象干
时承干
昌焕干
明干路
易纬干
晋干府
景宗干
曹干明
曾干亨
曾耀干
曾运干
曾鼎干
朱书干
朱干根
朴干华
李干初
李干右
李干山
李干明
李干朗
李干构
李干祐
李干铭
李干顺
李亨干
李仲干
李儇干
李先干
李光干
李再干
李子干
李封干
李广干
李承干
李润干
李白干
李贞干
李超干
李运干
李首干
杜干技
杜干海
杜干运
杜干鹏
杜伯干
杜明干
杜正干
来干清
杨干军
杨干尧
杨干山
杨干敏
杨干松
杨干武
杨干江
杨干运
杨文干
杨昱干
杨氏干
杨煜干
杨耀干
林九干
林干良
林安干
林道干
柳秉干
柳较干
桑干方
桑干源
梁干化
楚僧干
楼干贵
欧阳干
段治干
段震干
比干贞
毕干泰
毛干干
毛干伟
毛润干
水朝干
江干路
沈干定
沈有干
清雍干
温干振
溪干村
牛干岭
牛干村
牛正干
王丙干
王干归
王干盈
王干荣
王干龙
王干发
王仕干
王体干
王兆干
王克干
王刘干
王则干
王副干
王士干
王定干
王度干
王承干
王拉干
王振干
王晓干
王曰干
王正干
王永干
王洪干
王清干
王炳干
王玉干
王琳干
王秉干
王立干
王笃干
王象干
王道干
王震干
田干村
田干镇
由萧干
白干枫
白干笙
白在干
白定干
皇干殿
真宗干
祝干松
祝尊干
秦大干
程博干
立承干
章振干
竺干威
管志干
米振干
罗干宜
罗光干
罗明干
翁干度
翁干明
翟干修
翟干右
肖干刚
肖承干
肖振干
肖汉干
肖辉干
胡干华
胡干善
胡干威
胡干康
胡干文
胡孝干
胡惠干
胡锡干
舒明干
艾秉干
芦志干
苏升干
若书干
范昌干
范维干
荆道干
莫干生
莫希干
莫惠干
萧干亮
萧干山
萧炳干
萧秉干
董干儒
董干董
董兆干
董太干
蒋立干
蒋羽干
蒲桃干
蓝干福
蔡干忠
蔡干汉
蔡孝干
薛克干
薛振干
藏于干
裴大干
西干泊
西邻干
言伯干
许干峰
许干慰
许干雷
许志干
谢干干
谢干成
谢干龙
谢隆干
谷双干
贾干瑞
赖仁干
赖在干
赵干干
赵干斌
赵干景
赵干民
赵干琨
赵应干
赵振干
赵秉干
过干清
邓宏干
邓浩干
郎干义
郎干干
郑干明
郑干龙
郝友干
郭干晖
郭干祐
郭富干
郭振干
郭震干
金问干
钟孺干
钟树干
钟纯干
阮干秋
陈乃干
陈干初
陈干奕
陈干康
陈干志
陈干文
陈干旺
陈干芝
陈干锐
陈其干
陈加干
陈存干
陈广干
陈德干
陈才干
陈振干
陈文干
陈明干
陈秋干
陈自干
陈通干
陈遇干
陈龙干
隆干居
隋之干
雍干之
雍干二
雍干间
雷坤干
雷复干
雷晋干
韦洪干
韦秉干
韩子干
韩德干
韩振干
颜干麟
马丙干
马干兄
马干村
马体干
马子干
马晋干
马瑞干
马邦干
骆继干
高干源
高干生
高体干
高加干
高友干
高宗干
高庚干
高拱干
高瑞干
黄干亨
黄干佳
黄干利
黄干师
黄干明
黄干生
黄客干
黄润干
黄秀干
黄秉干
齐俊干
上干头村
中干龙德
干丰超市
干丰酒店
干干翼翼
干亨通宝
干佳宾馆
干县锅盔
干园酒家
干塔木河
干安泥林
干封泉宝
干峰茶业
干州古城
干州四宝
干州锅盔
干平饭庄
干旋坤转
干昌大厦
干明寺塔
干景园林
干泰实业
干济医堂
干淳之治
干照光电
干端坤倪
干纲独断
干维装饰
干耀东港
干西五所
干豪集团
干辰舞团
干达婆王
干通化工
干都宾馆
干阳佳园
干阳村北
干骏大厦
干鹏公司
干龙创投
兢兢干干
加藤干三
唐干明月
唐僖宗干
基金通干
夕惕朝干
宋孝宗干
旋干转坤
日干夕惕
星干超市
昼干夕惕
普干法师
朝干夕愓
朝干夕阳
洪干超市
牛干岭村
终日干干
萧干先生
锦绣干城
陕西干县
青龙干院
颠干倒坤
一戎干宇泰
干丰大饭店
干佳大酒店
干县公安局
干县城关镇
干县豆腐脑
干唐轩活瓷
干增食品店
干天火灵珠
干安黄小米
干康大酒店
干弘园酒楼
干恒泰网吧
干成源宾馆
干明阁足道
干清大酒店
干满园酒店
干潭收费站
干潭镇中学
干生堂药店
干生福超市
干盛大酒店
干福五金店
干西乡政府
干通苑小区
干龙大酒店
兴干大酒店
康雍干食府
杨家骑龙干
深圳粤兴干
瑞通干水湾
鑫干食杂店
阳光干城苑
陈乃干文集
干丰信阳菜馆
干县县委党校
干县杨汉中学
干安县水字镇
干宝隆海鲜居
干御酱骨头馆
干德君大酒楼
干潭中心小学
干珠界通行令
干豪国际广场
干陀诃利尊者
兰州干盛诊所
南京干鑫电器
南川区干丰乡
唐干明月驿都
嘉百乐干潭店
场联路干溪路
大连干舟木业
天津干阳电子
杨凌干泰科技
浙江干龙鞋业
深圳易智通干
青岛干耳听力
青岛海干化工
干安县第一中学
干安县第七中学
干安县第九中学
干安县第八中学
干安县第四中学
干安县腾字学校
干康木业经销处
干溪第一幼儿园
干溪第二幼儿园
干潭镇人民政府
干豪斯克莱酒店
干鑫粮油食杂店
干鹊飞来语屋山
克东县干丰中学
坤牛干马运无边
宁河县干园酒家
峰峰干泰金碧苑
承德干阳大酒店
方世玉与胡惠干
桂花香里酒瓶干
深圳市干利电子
老干州四宝酒楼
金鞍玉勒锦连干
干务五山中心小学
干安县交通运输局
干安县仙字乡中学
干安县余字乡中学
干安县兰字乡中学
干安县安字镇中学
干安县所字镇中学
干安县水字镇中学
干安县让字镇中学
干安县赞字乡中学
干安县鳞字乡中学
通干证券投资基金
陕西省干县梁村镇
陕西省干县王村镇
干安县大布苏镇中学
兰州干盛日用品商行
沈阳市大干鞋业公司
淄博干丰锻压机床厂
深圳市丰干电子商行
深圳市干利电子商行
深圳市凯干电子商行
深圳粤兴干电子商行
上海颐干实业有限公司
兰州干亨商贸有限公司
兰州干正商贸有限公司
兰州干盛商贸有限公司
大连干圆经贸有限公司
江苏干天酒业有限公司
沈阳干宁电气有限公司
深圳市干宇盛电子商行
甘肃干圆商贸有限公司
甘肃干康工贸有限公司
白银干朝矿业有限公司
兰州干盛土菜馆有限公司
兰州干鑫源商贸有限公司
深圳市硅干科技有限公司
甘肃干昌能源化工总公司
白银市干泰工贸有限公司
荆州市干盛纺织有限公司
上海干大化工材料有限公司
兰州干新物业管理有限公司
兰州干盛电力物资有限公司
兰州干通广告有限责任公司
兰州干阳电子科技有限公司
兰州干龙物资有限责任公司
兰州大干石化产品有限公司
兰州子干商贸有限责任公司
北京干创伟业科技有限公司
汕尾红海湾田干金威服装厂
甘肃干宇电子科技有限公司
甘肃干源工贸有限责任公司
甘肃德干商贸有限责任公司
酒泉干兴科贸有限责任公司
兰州干鸿盛商贸有限责任公司
山西干源康药业有限责任公司
庆阳市干渊金属材料有限公司
德清县干龙化纤针织有限公司
武威市干丰物资有限责任公司
沧州市干宇机床附件有限公司
湖南正干堂生物科技有限公司
酒泉市干丰物资有限责任公司
兰州干正物资贸易有限责任公司
兰州干盛华奕电子科技有限公司
兰州干通石化科技有限责任公司
北京三干会计师事务所有限公司
嘉峪关市干城商厦有限责任公司
嘉峪关市干玉鑫服饰商行一分部
嘉峪关市干玉鑫服饰商行二分部
兰州干盛房地产开发有限责任公司
张掖市干恒广告装饰有限责任公司
甘肃干昌房地产开发有限责任公司
锡山市华干实业总公司皮革制品厂
庆阳市西峰区干丰设备租赁有限公司
嘉峪关市干顺机动车贸易有限责任公司
嘉峪关市干城商厦有限责任公司兰百商场
深圳市干鼎通信设备有限公司平凉分公司
甘肃干昌能源化工总公司东方美容美发中心
""".split())

def fix_qian_pattern(text):
    if '干' in text:
        found = False
        for i in range(len(text) - 1):
            for k in range(2, 10):
                if i + k >= len(text):
                    continue
                if text[i:i+k] in kQianWords:
                    found = True
                    break
        if found:
            text = re.sub(r'干', '乾', text)
    return text

kNotZheWords = set("""
劣迹昭着
声誉卓着
土着土偶
信誉卓着
仰屋着书
以微知着
笔名着作
成效卓着
臭名昭着
睹微知着
睹着知微
恶迹昭着
恩威并着
鸿篇巨着
皇皇巨着
积微成着
积微致着
见微知着
经典着作
楔子着作
彰明较着
彰明昭着
着名人物
着书立说
着作等身
""".split())

def fix_zhezhu_pattern(text):
    if '着' in text:
        found = False
        for i in range(len(text) - 1):
            for k in range(2, 10):
                if i + k >= len(text):
                    continue
                if text[i:i+k] in kNotZheWords:
                    found = True
                    break
        if found:
            text = re.sub(r'着', '著', text)
            text = re.sub(r'zhe', 'zhu', text)
    return text

kZhaoWords = set("""
一寻一个着
一拿一个着
一着不慎
一着被蛇
一鞭先着
前不着村后不着店
十捉九着
四铺子着地
寻找无着
急惊风撞着慢郎中
柳树上着
柳树上着刀
棋输先着
棋错一着
棋高一着
歪打正着
没着没落
百下百着
着三不着两
着着失败
瞎猫碰着死老鼠
走为上着
""".split())

def fix_zhao_pattern(text):
    if '着' in text:
        found = False
        for i in range(len(text) - 1):
            for k in range(2, 10):
                if i + k >= len(text):
                    continue
                if text[i:i+k] in kZhaoWords:
                    found = True
                    break
        if found:
            text = re.sub(r'zhe(?!n)', 'zhao', text)
    return text

kZhuoWords = set("""
不自着罗衣
东风齐着力
个人依习惯身份而着的服装
佛头着粪
先人着鞭
先我着鞭
可着色的
吃着不尽
吃衣着饭
固着底栖生物
土地定着物
头上着头
好着丹青图画取
密着拓扑
密着空间
寒梅着花未
枝附叶着
梵志翻着袜
沉着痛快
淡着燕脂匀注
深切着明
深切着白
添盐着醋
电解法防海生物污着系统
画蛇着足
着丝基因
着人先鞭
着我扁舟一叶
着衣的玛哈
知疼着热
知疼着痒
秋来未着花
穿红着绿
穿绸着缎
粘着空间
老树着花无丑枝
脚着谢公屐
装模着样
谁复着手为摩挲
近端着丝
都护铁衣冷犹着
都护铁衣冷难着
醉里簪花倒着冠
非单着丝
非端着丝
鞭辟着里
高地人的执着
魂不着体
黏皮着骨
当着不着
""".split())

def fix_zhuo_pattern(text):
    if '着' in text:
        found = False
        for i in range(len(text) - 1):
            for k in range(2, 10):
                if i + k >= len(text):
                    continue
                if text[i:i+k] in kZhuoWords:
                    found = True
                    break
        if found:
            text = re.sub(r'zhe(?!n)', 'zhuo', text)
    return text

# Main processing
if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('input', help='input file')
    parser.add_argument('output', help='output file')
    args = parser.parse_args()

    kActions = [fix_notzhu_pattern,
                fix_qian_pattern,
                fix_zhezhu_pattern,
                fix_zhao_pattern,
                fix_zhuo_pattern]

    with open(args.input, 'rb') as fin, open(args.output, 'wb') as fout:
        for line in fin:
            line = line.decode('utf-8')
            for action in kActions:
                line = action(line)
            fout.write(line.encode('utf-8'))
    print('Done')

