# -*- coding: utf-8 -*-

import re
import sys
import argparse

kZhuWords = set("""
专著
刘著
卓著
原著
史著
合著
名著
土著
大著
崔著
巨著
张著
所著
拙著
撰著
新著
无著
昭著
显著
杂著
李著
王著
编著
著书
著作
著名
著录
著文
著明
著称
著者
著译
著身
著述
著重
论著
译著
较著
遗著
钜著
馨著
何著胜
吕公著
土著人
大著作
方著作
显著地
显著性
显著的
显著者
编著者
著作人
著作史
著作权
著作者
著作郎
著名权
著名的
龚著剑
专著概览
世界著名
以微知著
仰屋著书
众目昭著
佛头著粪
信誉卓著
功劳卓著
功勋卓著
劣迹昭著
卓著威名
发愤著书
名著在线
四大名著
国内著名
国际著名
声誉卓著
外国名著
大附著散
威望素著
学术专著
学术著作
小附著散
彰明昭著
彰明较著
恶迹昭著
惊人显著
成效卓著
成效显著
成绩卓著
成绩显著
战功卓著
效果显著
文学名著
日新月著
显著加强
显著地位
显著成效
显著成绩
显著提高
显著效果
显著标志
显著特点
档案著录
殆显著的
比较显著
水中著盐
深切著明
深切著白
画蛇著足
皇皇巨著
睹微知著
睹著知微
科学著作
积微成著
积微致著
等身著作
罪恶昭著
臭名昭著
著书立言
著书立说
著书等身
著于竹帛
著作权人
著作权法
著作等身
著名主持
著名人士
著名企业
著名作家
著名品牌
著名商标
著名导演
著名教授
著名景点
著名演员
著名画家
著名经济
著名诗人
著者目录
著者索引
著述等身
见微知著
视微知著
识微知著
超超玄著
遐迩著闻
重要著作
非常显著
鸿篇巨著
名岂文章著
妙手著文章
寒梅著花未
显著性影响
显著性检定
显著性检验
显著性水平
见微而知著
长安遇冯著
丁著
丛著
丹著
仁著
伍著
俞著
修著
公著
冯著
卢著
又著
古著
叶著
吕著
吴著
周著
唐著
基著
子著
孙著
宁著
宓著
宗著
岑著
巫著
师著
帝著
康著
廉著
弓著
弘著
徐著
德著
惠著
戈著
文著
智著
曹著
林著
柯著
桑著
梁著
此著
毛著
永著
沈著
洪著
熊著
玄著
玉著
甘著
祖著
简著
缪著
肖著
莫著
萧著
著县
著史
著有
葛著
蔡著
袁著
诗著
辛著
邵著
郎著
金著
陶著
东著玄
乌斯著
云著蝉
仲马著
伍德著
何著青
余华著
俞樾著
倪匡著
傅玄著
先生著
刘向著
华著清
卢梭著
古龙著
吴淑著
吴著冲
周著祖
唐人著
姚谦著
孟森著
宋慈著
宋著玲
宦著学
尼父著
尼采著
席绢著
常著赤
庄羽著
康德著
张先著
张文著
张载著
彭著霞
影著协
德特著
怀特著
战著勋
戴著腕
摄著协
文著协
斯基著
斯密著
斯通著
方方著
明著天
明著灵
普勒著
曹禺著
曾朴著
曾著诗
曾著赋
朱应著
李冶著
李明著
李维著
杨著恩
杨著昆
格林著
梅著雨
沈著飞
洛斯著
王蒙著
班固著
祝著节
禄抱著
福柯著
程著卿
罗斯著
罗琳著
罗素著
耿著兮
胡著伟
胡适著
艾伦著
艾束著
莫尔著
莫愚著
萧韩著
著些子
著佐权
董桥著
蒋祁著
蓝兮著
蔡邕著
藤生著
藤著木
袁枚著
袁著祉
许慎著
贝克著
贝祖著
赖特著
郎著轻
郝歪著
郭著章
鄂勒著
金庸著
金波著
钱穆著
陆羽著
陈寿著
霍金著
韦伯著
韦达著
韩寒著
韩松著
音著协
马丁著
马拉著
马斯著
马登著
高登著
魏巍著
魏收著
鲍姆著
黄著诚
黄长著
齐人著
齐著铁
傅玄著诗
加藤繁著
千百秀著
司马光著
司马迁著
和田清著
张恨水著
欧阳修著
流潋紫著
积著之理
范文澜著
郭敬明著
黄百家著
稻盛和夫著
彼得海斯勒著
五百年来谁著史
文章合为时而著
尼日利亚钦努阿著
医著
范著
纪著
珑著
尤著
宾著
陈著
益著
寇著
费著
马欢著
辛格著
应劭著
莫斯著
山口升著
曲江华著中城
郭著
阀著
韦著
赵著
梅著
雷著
傅著
夏著
顾著
浦著
韶著
殳著
符著
宫著铭
卡尔著
尚著
士著
灵著
郑著
庄著
暴著
温著
干宝著
""".split())

def fix_notzhu_pattern(text):
    if '著' in text:
        found = False
        for i in range(len(text) - 1):
            for k in range(2, 10):
                if i + k >= len(text):
                    continue
                if text[i:i+k] in kZhuWords:
                    found = True
                    break
        if not found:
            text = re.sub(r'著', '着', text)
    return text

# Main processing
if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('input', help='input file')
    parser.add_argument('output', help='output file')
    args = parser.parse_args()

    kActions = [fix_notzhu_pattern]

    with open(args.input, 'rb') as fin, open(args.output, 'wb') as fout:
        for line in fin:
            line = line.decode('utf-8')
            for action in kActions:
                line = action(line)
            fout.write(line.encode('utf-8'))
    print('Done')

