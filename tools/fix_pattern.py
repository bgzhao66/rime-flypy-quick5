# -*- coding: utf-8 -*-

import re
import sys
import argparse

kLiWords = set("""
丁裡鎮
三門裡
上裡塬鄉
上裡鎮
下廿裡鋪鄉
下碣隅裡
中山裡
中裡
中裡巴人
中裡廂鄉
中裡鄉
中裡鎮
久姆裡
亨裡克
亨裡克森
亨裡埃塔
亨裡奇
亨裡格
仁裡水族鄉
仁裡街道
仁裡鎮
仁裡集鎮
仁讓裡鄉
伊勒呼裡山
伊卜裡
伊圖裡
伊夫裡
伊裡
伊裡其鄉
伊裡安
伊裡安島
伊裡安查亞
伍德伯裡
伯裡
伽裡略
佈雷德伯裡
佈雷茲裡克
佛羅裡
佛裡曼特爾
佩裡
佩裡克
佩裡格
佩裡耶
來安裡
保安裡
傑弗裡
傑裡
傑裡揚拜特奈
傑裡邁亞
光明裡社區
光裕裡
克勞裡
克拉裡
克拉裡薩
克萊裡
克萊裡季斯
冬筍裡脊絲
凹裡村
利裡河
利韋裡
嘉裡中心
北原裡英
北王裡鎮
北洋新裡
南小街中裡
南門裡
南香裡
博裡
博裡鎮
卡拉麥裡山
友阪裡惠
古裡安
古裡耶夫
周裡京
哈伊裡
哈利裡
哈扎裡
喀什噶裡
喬戈裡
喬戈裡峰
喬杜裡
喬裡克
回裡鎮
圈裡鄉
圖裡奧
圖裡安
坳裡鄉
埃夫裡
埃弗裡
埃弗裡特
埃思裡奇
埃斯克裡瓦
埃瑟裡克斯
埃裡
埃裡克
埃裡克松
埃裡克森
埃裡卡
埃裡希
埃裡戈爾
埃裡溫
埃默裡
埃默裡奇
基夫裡克
基夫裡克奧盧
基摩裡安
基爾裡克
基裡
基裡安
基裡延科
基裡洛夫
基裡洛維奇
塔克裡提
塔夫裡
塔裡克
塔裡哈
塔裡夫
塔裡娜
塔裡查
塞恩斯伯裡
墩買裡街道
夏木麻裡
夕陽綻放千萬裡
多布庫裡河
天高地平千萬裡
太平裡鄉
奧爾德伯裡
奧瑪裡恩
奧裡克
奧裡克斯
奧裡恩
奧裡森
奧裡涅
奧裡登
奧裡諾科
奧裡諾科河
奧裡雅
奧赫裡德
奧赫裡德湖
奧韋裡
奧馬裡
宜裡鎮
宮澤裡惠
容裡中學
容裡小學
寨裡村
寨裡河
寨裡河鄉
寨裡鄉
寨裡鎮
寶盛裡
寶盛裡小區
小裡崗
小裡鎮
尚仁裡
尚仁裡鄉
尤克裡裡
屯裡林場
屯裡鎮
山裡鄉
峪裡村
崇文裡
平裡店
平裡店鎮
平裡鎮
幸福裡
幾百裡
康定裡
康靜裡
康靜裡南
廈門市湖裡區
延靜裡
建明裡社區
弗勒裡
弗洛裡
弗洛裡安
弗羅裡斯鼠屬
弗裡克
弗裡堡
弗裡奇
弗裡希
弗裡德
弗裡德堡
弗裡德曼
弗裡德海姆
弗裡德爾
弗裡德蘭
弗裡德蘭德
弗裡德裡
弗裡德裡克
弗裡思
弗裡施
弗裡林
弗裡波特
弗裡特
弗裡登
弗裡登胡普
弗裡索
弗裡茨
弗裡蒙特
弗裡蘭
弗裡西亞
弗裡達
張裡鄉
彼得裡
復興裡
復興裡街
德厚裡
德弗裡
德魯裡
徹裡吉
忽那汐裡
恩濟裡小區
恩裡克
恩裡克斯
惠新裡
惱裡鎮
愛內裡
愛內裡菜
慧忠裡
戈裡
戈裡峰
戈裡耶夫
托裡拆利
拉克西裡
拉布裡
拉扎裡
斯伯裡
斯佩裡
斯克裡夫納
斯克裡普斯
斯庫裡
斯托裡
斯特裡克蘭
斯皮裡
斯科裡
新園裡
新安裡
新昌裡
新源裡
新興裡
新艾裡蒙古族鄉
新裡城
新裡鎮
於裡安
於裡鎮
昔裡吉
春園裡
春武裡
普裡什蒂納
普雷裡城
暖武裡
暖武裡府
暗頭裡
曙光裡
月裡鎮
望裡鎮
朝裡瑤族鄉
朱裡鎮
杜伊勒裡
杜裡
杜裡埃
東套裡村
東平裡
東槐裡衚衕
東買裡鄉
松榆裡
林裡鄉
果和裡
果園新裡北區社區
果戈裡
果裡鎮
查裡
格列高裡
格裡戈裡
格裡戈裡耶
格裡戈裡耶夫
格裡戈裡耶維奇
格裡戈里
格裡戈里耶
格裡戈里耶夫
格裡戈里耶維奇
格雷戈裡
桑伯裡
森茨伯裡
楊展裡
楊雄裡
樂裡河
樂裡鎮
樓桑裡
標裡鎮
歐麥裡
毛裡坦猿人
毛裡塔
毛裡塔尼
毛裡塔裡亞
毛裡崗鄉
毛裡裘斯
毛裡鄉
民豐裡
水裡納瓜
永安裡
沃裡克
沃裡克郡
沙耶武裡
沙裡奇
沙裡寧
沙裡寨鎮
沙裡河
沙裡瑤族鄉
沙裡院
沙魯裡山
泊裡鎮
法裡序列
法裡恩
法赫裡
波切裡
波德戈裡察
波爾菲裡
泰安裡
泰裡恩
洛克裡
洛裡默
洞裡薩湖
浣衣裡
海因裡希
海因裡希斯
海底兩萬裡
海棠裡
深塘裡
湟裡鎮
溫井裡
溫弗裡
漳裡村
烏爾裡
烏爾裡克
烏蘇裡
烏蘇裡圓田螺
烏蘇裡虎
烏蘇裡躍度蝗
烏蘇裡鮠
牙裡鎮
特內裡弗
特吾裡克鎮
特木裡鎮
特羅布裡奇
玉蘭裡
珍巷裡
班伯裡
班達裡
瑟裡耶克
瑤裡鎮
瑪傑裡
瑪爾裡
瑪瑟裡頓
瑪科裡石板
瑪艾裡
瑪裡甘
瑪裡苟斯
環湖裡
瓜裡鄉
瓢裡鎮
瓦列裡
瓦勒裡
瓦希裡
瓦萊裡
瓦雷裡
甫裡
甫裡先生
甲裡橋
甲裡鎮
疃裡一區
疃裡三區
疃裡二區
疃裡新村
疃裡村
疃裡鎮
益壽裡
盧漢熱裡
直沽街匯賢裡
真理道華泰裡
真興裡
睦裡村
瞳裡三區
知春裡
知春裡東站
石獅市鳳裡派出所
石裡鄉
碧裡鄉
碧雲裡
社裡鄉
福壽裡
禮堂裡
禹帳裡
禹裡鄉
科爾裡奇
科裡登
科達裡
程林裡
穆維裡克
穆裡耶
章裡集鄉
範裡鎮
克裡斯朵夫
紅蓮中裡
紅裡山村
納林希裡鎮
納賽裡
紐伯裡
索爾茲伯裡
索裡
紹裡木
統裡村
維埃裡
維耶裡
維裡
維裡副隊長
維裡甘之拳
綺裡
綺裡季
綺裡祠
罈子裡
羅勃羅裡
羅勃羅裡葛茲
羅裡
羅裡熊
羅裡羅
羅裡羅唆
羅裡羅嗦
羅裡葛茲
羅裡鄉
羅馬裡
羊裡鎮
翟裡村
翠微中裡
老根裡
老觀裡村
耶律僕裡篤
耶律糾裡
耶律解裡
耶裡
耶裡奇
耶裡鎮
聖斯皮裡圖斯
育慧裡
胡裡山
胡裡改
胡裡清
能仁裡
臘塔納基裡
臥裡屯
臥裡屯街道
臥裡屯鄉
臥裡託格拉克鄉
自夥淘裡
一百許裡
興業裡
艾裡
艾裡微分方程
艾默裡
艾默裡克
芙蓉裡
芙蓉裡小區
芬裡克
芳園裡社區
苑裡鎮
英買裡鄉
英買裡鎮
莫濟裡
莫蒂裡安尼
菊花裡
華安裡
菲奧裡
萬裡雲梟
葉裡溫
蒂珀雷裡
蒂耶裡
蒂裡特
蒂裡特
蒙多基裡
蒙特裡
蒙特裡安
蔣裡莊
蔣裡莊村
薩克裡
藤川優裡
蘇裡南河
蘭裡島
蘭裡鎮
虎丘路豐樂裡
蛯原友裡
衡清裡
衷裡衣
裡也波
裡佩爾
裡傑卡爾德
裡光溪
裡克斯
裡克曼
裡克森
裡克爾
裡克爾梅
裡克西
裡克鄉
裡內庭
裡切特
裡則街道
裡南鄉
裡南鎮
裡卡多
裡卡德
裡卡爾
裡卡爾多
裡卡蒂微分方程
裡卡馬
裡古魯
裡吉斯
裡商鄉
裡地屯
裡坦鎮
裡埃爾
裡城道鄉
裡基特
裡塔尼
裡塔鎮
裡塘村
裡塞特
裡壩鎮
裡士多德
裡夏爾
裡多夫
裡夫斯
裡夫林
裡奇偉海蜥魚
裡奇斯
裡奇曲率
裡奇曼
裡奇韋
裡姆
裡姆斯
裡姆斯基
裡姆斯基柯薩科夫
裡姆斯基科薩科夫
裡季斯
裡安古
裡安娜
裡山彝族鄉
裡山街道
裡山鎮
裡岔鎮
裡市鄉
裡希斯
裡希爾
裡希特
裡帶裡根
裡幹事
裡庫佩羅
裡弗塞斯
裡弗塞斯城
裡弗斯
裡德
裡德二極管
裡德利
裡德帕思
裡德斯
裡德曼
裡德爾
裡德蒸氣壓
裡德集團
裡扎爾
裡摩日
裡普利
裡普斯
裡普曼
裡曼
裡朗威
裡望鄉
裡木湖
裡村街道
裡村路
裡村鎮
裡松鎮
裡查德
裡查森
裡格利
裡格斯
裡格斯訴帕爾默案
裡格爾
裡格特
裡梅爾
裡橫街
裡比多
裡氟康唑
裡沃利
裡沃利會戰
裡法伊
裡法特
裡洞島
裡洞鎮
裡浦鎮
裡潭鄉
裡瀾城鎮
裡炮村
裡烏斯
裡特斯
裡特曼
裡特爾
裡瓦多
裡瓦斯
裡瓦爾
裡瓦爾多
裡瓦索
裡瓦諾
裡瓦達維亞
裡田鄉
裡田鎮
裡當瑤族鄉
裡真德
裡砦鎮
裡窩那
裡米尼
裡素勞
裡索斯
裡維伊
裡維利諾
裡維加茲
裡維埃
裡維埃拉
裡維斯
裡維爾
裡維特
裡維耶
裡維耶拉
裡耶
裡耶卡
裡耶夫
裡耶維奇
裡耶鎮
裡能集團
裡茨
裡茨方法
裡莫夫
裡萊恩斯堡
裡葉白蓮
裡薩斯
裡薩爾
裡蘭吉尼
裡諾夫
裡貝克
裡貝拉
裡貝爾
裡貝特
裡貝羅
裡連科
裡遊蕩
裡運河
裡道斯
裡陽鄉
裡雍鎮
裡韋拉
裡韋爾
裡韋特
裡韋羅
裡馬房
裡高鎮
裡齊奧
裡龍鄉
西出都門百餘裡
西園裡
西安裡
西格弗裡
西格弗裡德
西槐裡衚衕
西沃裡
西沙裡村
西溝裡村
西瀛裡
西紐列裡
西裡爾字母
西門裡街道
西馬路衛安中裡
西龐裡村
觀裡鎮
觀音裡
記裡堆
記裡車
記裡鼓
記裡鼓車
諾塔裡
譚家裡
豐沙裡
豐沙裡省
豔陽裡
貝弗裡奇
貝弗裡奇天線
貝洛奧裡藏特
費裡埃
費裡特
賽裡木
賽裡木江
賽裡木街道
賽裡木鎮
赫希底裡群島黑龍
赫舍裡
赫茲裡特
赫裡
赫裡克
赫裡掃
赫裡福
赫裡福德
趙沽裡
趙沽裡大街
踏裡彩
車裡墳村
軟炸裡脊
輯裡村
輯裡絲
辛裡奇
辭職歸裡
農光裡中社區
農豐裡
迎賓街建安裡
迎賓街晨暉裡
迪裡克
迪裡拜爾
連裡村
連裡竟街
達爾瑪裡
達裡婭
達裡巴鄉
達裡索
達裡諾爾
達裡諾爾湖
邁杜古裡
郭裡園
郭裡鎮
都悅裡小區
鄉舉裡選
鄭君裡
鄭軍裡
酩子裡
金臺裡
金裡奇
鉅鋒裡
錦江裡
錦裡中路
錦裡開芳宴
錫惠裡
錫慶裡
鐵幹裡克
鐵幹裡克鄉
鐵木裡克河
鐵木裡克鄉
鐵裡溫
鑫福裡
長塘裡
長汀裡
長風幾萬裡
閃裡鎮
開陽裡
閒深裡
閔子裡
阿主沙裡
阿什裡
阿什裡哈薩克族鄉
阿卜達裡
阿合別裡鬥鄉
阿圖裡斯
阿姆裡
阿布裡
阿帕裡
阿庫裡
阿庫雷裡
阿得裡
阿扎裡
阿斯圖裡亞
阿斯托裡
阿沃裡
阿科裡鄉
阿穆裡
阿裡里
阿詐裡
阿赫蒂薩裡
阿馬裡
阿馬裡洛
阿默裡寶螺
隆裡鄉
雅寶裡
雅瑪裡克山
雅裡卡
集裡街道
集裡街道辦事處
集賢裡
雍裡鄉
霍日裡河
青得裡鄉
青雲裡
靜安裡
革新裡
革新道匯光裡
韃韃裡
韋裡村
韋裡諾
領裡鄉黨
香榭裡
香榭裡花園
香裡奈
馬傑裡
馬克裡
馬嘉裡事件
馬基雅維裡式
馬布裡
馬斯特裡赫特
馬斯特裡赫特條約
馬洛裡
馬紮裡
馬紮裡沙裡夫
馬蘇裡
馬蘇裡拉
馬裡
馬裡亞納海溝
馬裡共和國
馬裡博爾
馬裡卜
馬裡卡
馬裡安
馬裡恩
馬裡恩島鮈南極魚
馬裡政府
馬裡特
馬裡翁
馬裡薩
馬裡諾
馬裡隊
馬連道中裡
馬達裡
騰格裡沙漠
高崗裡
高裡掌村
高裡津
高裡鄉
高裡鎮
魆地裡
魯傑裡
鮑裡索夫
鴻順裡
麥克裡
麥克裡迪
麻裡鄉
麼裡鎮
黎曼羅裡群
黎裡鎮
鼇裡奪尊
龍井裡
龍蟠裡
中陽裡
""".split())

def fix_li_pattern(text):
    if '裡' in text:
        found = False
        for i in range(len(text) - 1):
            for k in range(2, 6):
                if i + k >= len(text):
                    continue
                if text[i:i+k] in kLiWords:
                    found = True
                    break
        if found:
            text = re.sub(r'裡', '里', text)
    return text

def fix_li2_pattern(text):
    if '裡' in text:
        text = re.sub(r'(?<=[百千萬幾數餘])裡(?![挑])', '里', text)
    return text

def fix_shishi_pattern(text):
    if '即時' in text:
        text = re.sub(r'即時(?=.+shi shi)', '實時', text)
    return text

def fix_jiang_pattern(text):
    if '蔥姜' in text:
        text = re.sub(r'蔥姜', '蔥薑', text)
    return text

def fix_tuanhuo_pattern(text):
    if '團伙' in text:
        text = re.sub(r'團伙', '團夥', text)
    return text

def fix_baogan_pattern(text):
    if '包乾' in text:
        text = re.sub(r'包乾', '包幹', text)
    return text

def fix_ganzao_pattern(text):
    if '幹棗' in text:
        text = re.sub(r'幹棗', '乾棗', text)
    return text

def fix_xian_pattern(text):
    if '鹹' in text:
        text = re.sub(r'(?<=[一上下二亨仲佔來俯傅克入兩包匡和大小少尹崔左巫張徐敬斯景李杖杜東浴為王申稼範繼續聰苑英蕭衡西貞賀速道都阮阿陳雉雲韶])鹹', '咸', text)
    return text

def fix_xian2_pattern(text):
    if '鹹' in text:
        text = re.sub(r'鹹(?=[之京以伏共唐喜宜寧已弼恆應昧欽池熙用秩稱第籍茫藎豐躓陽離騖平])', '咸', text)
    return text

# Main processing
if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('input', help='input file')
    parser.add_argument('output', help='output file')
    args = parser.parse_args()

    kActions = [fix_li_pattern,
                fix_li2_pattern,
                fix_shishi_pattern,
                fix_jiang_pattern,
                fix_tuanhuo_pattern,
                fix_baogan_pattern,
                fix_ganzao_pattern,
                fix_xian_pattern,
                fix_xian2_pattern]

    with open(args.input, 'rb') as fin, open(args.output, 'wb') as fout:
        for line in fin:
            line = line.decode('utf-8')
            for action in kActions:
                line = action(line)
            fout.write(line.encode('utf-8'))
    print('Done')

